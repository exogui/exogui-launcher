<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <!-- Title -->
  <text x="400" y="30" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#333" text-anchor="middle">Socket Communication Architecture</text>

  <!-- Renderer Process Box -->
  <rect x="50" y="60" width="700" height="180" fill="#E67E22" stroke="#A0522D" stroke-width="2" rx="5"/>
  <text x="400" y="90" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="white" text-anchor="middle">Renderer Process</text>

  <!-- SocketClient section -->
  <rect x="80" y="110" width="640" height="110" fill="#F39C12" stroke="#A0522D" stroke-width="1" rx="3"/>
  <text x="400" y="135" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white" text-anchor="middle">window.External.back (SocketClient)</text>

  <!-- API calls -->
  <text x="100" y="165" font-family="Courier New, monospace" font-size="12" fill="white">.request(BackIn.LAUNCH_GAME, data)</text>
  <text x="100" y="190" font-family="Courier New, monospace" font-size="12" fill="white">.register(BackOut.GAME_CHANGE, handler)</text>

  <!-- WebSocket connection -->
  <rect x="250" y="270" width="300" height="80" fill="#9B59B6" stroke="#6C3483" stroke-width="2" rx="5"/>
  <text x="400" y="295" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white" text-anchor="middle">WebSocket</text>
  <text x="400" y="315" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">ws://localhost:dynamic-port</text>
  <text x="400" y="335" font-family="Arial, sans-serif" font-size="11" fill="white" text-anchor="middle">Authentication: secret handshake ("exogui-launcher")</text>

  <!-- Connection arrows -->
  <line x1="400" y1="240" x2="400" y2="270" stroke="#6C3483" stroke-width="3" marker-end="url(#arrowhead-ws)"/>
  <line x1="400" y1="350" x2="400" y2="380" stroke="#6C3483" stroke-width="3" marker-end="url(#arrowhead-ws)"/>

  <!-- Backend Process Box -->
  <rect x="50" y="380" width="700" height="190" fill="#50C878" stroke="#2E7D4E" stroke-width="2" rx="5"/>
  <text x="400" y="410" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="white" text-anchor="middle">Backend Process</text>

  <!-- SocketServer section -->
  <rect x="80" y="430" width="640" height="60" fill="#27AE60" stroke="#2E7D4E" stroke-width="1" rx="3"/>
  <text x="400" y="455" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white" text-anchor="middle">SocketServer (src/back/SocketServer.ts)</text>
  <text x="100" y="477" font-family="Courier New, monospace" font-size="12" fill="white">.register(BackIn.LAUNCH_GAME, handler)</text>

  <!-- Processing Pipeline -->
  <g>
    <!-- Middleware box -->
    <rect x="100" y="505" width="180" height="40" fill="#1ABC9C" stroke="#16A085" stroke-width="1" rx="3"/>
    <text x="190" y="530" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">Middleware Pipeline</text>

    <!-- Arrow -->
    <line x1="280" y1="525" x2="320" y2="525" stroke="#16A085" stroke-width="2" marker-end="url(#arrowhead-green)"/>

    <!-- Request Queue box -->
    <rect x="320" y="505" width="180" height="40" fill="#1ABC9C" stroke="#16A085" stroke-width="1" rx="3"/>
    <text x="410" y="530" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">Request Queue</text>

    <!-- Arrow -->
    <line x1="500" y1="525" x2="540" y2="525" stroke="#16A085" stroke-width="2" marker-end="url(#arrowhead-green)"/>

    <!-- Handlers box -->
    <rect x="540" y="505" width="180" height="40" fill="#1ABC9C" stroke="#16A085" stroke-width="1" rx="3"/>
    <text x="630" y="525" font-family="Arial, sans-serif" font-size="12" fill="white" text-anchor="middle">Registered Handlers</text>
    <text x="630" y="540" font-family="Arial, sans-serif" font-size="10" fill="white" text-anchor="middle">(responses.ts)</text>
  </g>

  <!-- Arrow markers -->
  <defs>
    <marker id="arrowhead-ws" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#6C3483"/>
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#16A085"/>
    </marker>
  </defs>
</svg>